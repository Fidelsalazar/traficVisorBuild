!function(){"use strict";class e{constructor(e){window.modals=!0;const t={modalSelector:"#hswp-dynamic-modal",slugs:[...window.global.postTypes],autoload:!1,preloader:!0,size:!1,deepLinking:!0,deepSuffix:"md",gallery:{enabled:!1,arrows:!0,item:"figure",onchange:function(e,t){e.find(".modal-content img.gallery-item").attr("src",t)}}};this.settings=$.extend(!0,t,e||{}),this.changeSize(),this.attachEvents()}attachEvents(){let e=this;this.settings.deepLinking&&this.deepHandle(),$(document).on("click","a",(t=>{const s=$(t.currentTarget),i=s.attr("href");if(this.isModalLink(s)&&(t.preventDefault(),this.sendAjax({action:"ajax-modal",url:i})),1==e.settings.gallery.enabled&&this.isImageLink(i)){this.el=s,t.preventDefault();let e=[this.settings.gallery.arrows?'<button class="arrow prev"></button>':"",this.settings.gallery.arrows?'<button class="arrow next"></button>':""];$(`${this.settings.modalSelector} .modal-content`).html(`<img class="gallery-item" src='${i}'/>`),$(`${this.settings.modalSelector} .arrow`).length||$(`${this.settings.modalSelector}`).append(e),this.attachGalleryEvents(),$(this.settings.modalSelector).addClass("reveal-gallery").foundation("open")}}))}attachGalleryEvents(){if(this.settings.gallery.arrows){this.setArrowsVisibility(this.el),this.keyControls();const e=$._data($(`${this.settings.modalSelector} button.arrow`)[0],"events");e&&e.click||$(`${this.settings.modalSelector} button.arrow`).on("click",(e=>{console.log("Print"),e.preventDefault(),$(e.target).hasClass("prev")&&this.switchImage(this.prev.find("img").attr("src"),"prev"),$(e.target).hasClass("next")&&this.switchImage(this.next.find("img").attr("src"),"next"),this.keyControls()}))}}keyControls(){$(document).on("keydown",(e=>{e.preventDefault(),37===e.keyCode&&this.prev.length&&this.switchImage(this.prev.find("img").attr("src"),"prev"),39===e.keyCode&&this.next.length&&this.switchImage(this.next.find("img").attr("src"),"next")})),$(document).on("closed.zf.reveal",`${this.settings.modalSelector}[data-reveal]`,(function(){$(document).off("keydown")}))}switchImage(e,t){"function"==typeof this.settings.gallery.onchange&&this.settings.gallery.onchange($(this.settings.modalSelector),e),this.setArrowsVisibility(this[t])}setArrowsVisibility(e){this.el=e||this.el,this.next=this.el.closest(this.settings.gallery.item).next(),this.prev=this.el.closest(this.settings.gallery.item).prev(),this.toggleArrows("prev"),this.toggleArrows("next")}toggleArrows(e){this[e].length?$(`${this.settings.modalSelector} .arrow.${e}`).removeClass("hide"):$(`${this.settings.modalSelector} .arrow.${e}`).addClass("hide")}isModalLink(e){return!e.data("disable-modal")&&e&&this.settings.slugs.some((t=>e.attr("href").includes(`/${t}/`)))}isImageLink(e){return e&&null!=e.match(/\.(jpeg|jpg|gif|png|webp)$/)}changeSize(){this.settings.size&&$(this.settings.modalSelector).addClass(this.settings.size)}deepHandle(){const e=this.getSlug();this.removeHash(),e&&this.sendAjax({action:"ajax-modal",slug:e})}getSlug(){return location.hash.substr(1,location.hash.indexOf(`-${this.deepSuffix}`)-1)}removeHash(){$(document).on("closed.zf.reveal",this.modalSelector,(()=>{history.replaceState(null,null," "),$(`${this.settings.modalSelector} .modal-content`).html(""),$(this.modalSelector).removeClass().addClass("reveal"),$(this.modalSelector).parent().removeClass().addClass("reveal-overlay")}))}sendAjax(e){jQuery.ajax({type:"post",dataType:"json",url:window.global.ajaxurl,data:e,beforeSend:e=>{this.settings.preloader&&($("body").addClass("loading"),$(this.settings.modalSelector).removeClass("reveal-gallery").foundation("open"))},success:e=>{"success"==e.response&&(this.settings.deepLinking&&(location.hash=`${e.slug}-${this.settings.deepSuffix}`),e.size&&($(this.settings.modalSelector).addClass(e.size).removeClass(this.settings.size),$(".reveal-overlay").addClass(e.size.replaceAll(" ","-")+"-overlay")),$(`${this.settings.modalSelector} .modal-content`).html(`<iframe width="420" height="315" frameborder="0" src="${e.iframe}?no-header=true"/>`))}}).done((()=>{const e=this;this.settings.preloader&&$("body").removeClass("loading"),$(document).trigger("modal_loading_finished",[]),$(".modal-content iframe").on("load",(function(){$(e.settings.modalSelector+" .modal-content iframe").contents().find(".close-button").on("click",(t=>{$(e.settings.modalSelector).foundation("close")})),jQuery(".modal-content iframe").contents().click((function(t){"HTML"===t.target.tagName&&$(e.settings.modalSelector).foundation("close")}))}))}))}}1==window.global.enable&&void 0===window.modals&&jQuery((function(t){new e({preloader:!0,gallery:{enabled:window.global.gallery}})}))}();